<!DOCTYPE html>
<html>
<head>
<title>Robot Math AI</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>
body{
    margin:0;
    overflow:hidden;
    font-family:Arial;
    background:#0f2027;
    color:white;
}
#robotCanvas{
    position:absolute;
    top:0;
    left:0;
}
.chatBox{
    position:absolute;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    width:60%;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(20px);
    padding:20px;
    border-radius:20px;
}
input{
    width:80%;
    padding:12px;
    border:none;
    border-radius:10px;
}
button{
    padding:12px;
    border:none;
    border-radius:10px;
    background:#00f5ff;
}
.messages{
    max-height:200px;
    overflow-y:auto;
    margin-bottom:10px;
}
.user{ text-align:right; margin:5px; }
.bot{ text-align:left; margin:5px; color:#00f5ff; }
.top{
    position:absolute;
    top:10px;
    right:20px;
}
</style>
</head>
<body>

<div class="top">
User: {{user}} | <a href="/logout" style="color:#00f5ff;">Logout</a>
</div>

<canvas id="robotCanvas"></canvas>

<div class="chatBox">
<div class="messages">
{% for msg in chat %}
<div class="user">You: {{msg.user}}</div>
<div class="bot">Robot: {{msg.bot}}</div>
<script>
speak("{{msg.bot}}");
</script>
{% endfor %}
</div>

<form method="POST">
<input name="expression" placeholder="Ask me math..." required>
<button type="submit">Send</button>
</form>
</div>

<script>
// ================= TEXT TO SPEECH =================
function speak(text){
    const speech = new SpeechSynthesisUtterance(text);
    speech.pitch = 0.8;
    speech.rate = 1;
    speech.lang = "en-US";
    window.speechSynthesis.speak(speech);
}

// ================= 3D ROBOT =================
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({canvas:document.getElementById("robotCanvas"), alpha:true});
renderer.setSize(window.innerWidth, window.innerHeight);

const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshStandardMaterial({color:0x00f5ff});
const cube = new THREE.Mesh(geometry, material);
scene.add(cube);

const light = new THREE.PointLight(0xffffff,1);
light.position.set(5,5,5);
scene.add(light);

camera.position.z = 3;

function animate(){
    requestAnimationFrame(animate);
    cube.rotation.x += 0.01;
    cube.rotation.y += 0.01;
    renderer.render(scene,camera);
}
animate();
</script>

</body>
</html>
